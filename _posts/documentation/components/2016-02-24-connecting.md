---
layout       : feature-doc
title        : "Connecting"
date         : 2016-02-24 00:31:01 +0000
date_updated : 2016-01-24 00:31:02 +0000

f_image      : "/images/server-events@2x.png"
categories   : general
tax          : general
---
Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s
<!--more-->

## Introduction
Both the `cwc-display-master.js` and `cwc-controller-master.js` have a built in server object, allowing each client to connect to the server. The following pramaters have to set when initiating the **cwc.Server** object.

| Setting  | Type     | Vales                                         |
| -------- | -------- | ----------------------------------------------|
| host     | Sting    | http://localhost.com                          |
| port     | Int      | 5000                                          |
| type     | Sting    | 'ws'                                          |


#### JavaScript Declaration

{% highlight javascript linenos %}
/*------------------------------------------------------
* @object - CWC Main Server Object
* @info   - Establishing a connection to the server
*/
Server = new cwc.Server({
    host : 'http://localhost.com',
    port : 0000,
    type : 'ws'
});
{% endhighlight %}

>**Chameleon Web Controller** only has support for WebSocket, in near futrue we hope to releases support for other Node Sockets implementations.

## Connect method
Whence the `cwc.Server` object is initiated, calling the `connect` method on the object will allow the clinet to connect.

#### Display (cwc-display-master.js)
{% highlight javascript linenos %}
/*------------------------------------------------------
* @methord - cwc.Server Connect methord
* @info    - cwc-display-master.js
*/
Server.connect(
);
{% endhighlight %}

#### Controller (cwc-controller-master.js)
{% highlight javascript linenos %}
/*------------------------------------------------------
* @methord - cwc.Server Connect methord
* @info    - cwc-controller-master.js
*/
Server.connect(
  000000 // You must provid cluster code
);
{% endhighlight %}

>Only the cluster-code is required when trying to connect a controller. Otherwise the `cluster-code` is auto generated by the display.

## Connection Hooks
Predefined hooks can be set up on both the display and controller clinets to capture connection methord sent from the server.

| Hook name               | cwc-display-master.js | cwc-controller-master.js |
| ------------------      | :-:                   | :-:                      |
| connection-success      | &#x2714;              | &#x2714;                 |
| connection-failed       | &#x2714;              | &#x2714;                 |
| controller-connected    | &#x2714;              | &#x2718;                 |
| controller-disconnected | &#x2714;              | &#x2718;                 |

## On connection success hook
A predefined hook can be set up on both the display and controller clinets to capture a `connection-sucsess` event from the server. Hook will need to be defined before calling the `connect` method.

| Hook name          | Type    | Invoked by server                                         |
| ------------------ | --      | --------------------------------------------------------- |
| connection-success | Hook    | Called when the clinet has sucsessfuly connected          |

{% highlight javascript linenos %}
/* -- Crete connection sucsess | Hook -- */
Hooks.set_hook( {
  hook_name : 'connection-success',
  method    : function( feedback ) { on_connect( feedback ) }
} );
{% endhighlight %}

## On connection failed hook
A predefined hook can be set up on both the display and controller clinets to capture a `connection-failed` event from the server. Hook will need to be defined before calling the `connect` method.

| Hook name          | Type | Invoked by server                                         |
| ------------------ | --   | --------------------------------------------------------- |
| connection-failed  | Hook | Called when the clinet has failed to connecte             |

{% highlight javascript linenos %}
/* -- Crete connection failed | Hook -- */
Hooks.set_hook( {
  hook_name : 'connection-failed',
  method    : function( feedback ) { console.log( data ); }
} );
{% endhighlight %}

## Controller connected hook
Hooks can also created to capture a `controller-connected` messaged from the server. This hook can only be set on clients using the **cwc-controller-master.js** file.

| Hook name            | Type | Invoked by server                                         |
| ------------------   | --   | --------------------------------------------------------- |
| controller-connected | Hook | Called when the clinet has connected to the display       |

{% highlight javascript linenos %}
/* -- Crete controller connected | Hook -- */
Hooks.set_hook( {
  hook_name : 'controller-connected',
  method    : function( controller ) { controller_connected( controller ) }
} );
{% endhighlight %}

## Controller disconnected hook
Created a hook to capture the `controller-disconnected` message. This to can only be set on clients using the **cwc-controller-master.js** file.

| Hook name               | Type | Invoked by server                                         |
| ------------------      | --   | --------------------------------------------------------- |
| controller-disconnected | Hook | Called when the clinet has disconnected from the display  |

{% highlight javascript linenos %}
/* -- Crete controller disconnected | Hook -- */
Hooks.set_hook( {
  hook_name : 'controller-disconnected',
  method    : function( controller ) { controller_disconnected( controller ) }
} );
{% endhighlight %}

## Feedback infromation
`connection-success` , `connection-failed` , `controller-connected` , `controller-disconnected` when invoked by the server all receive feedback information from the server. The table below outlines the infromation sent by the server.

| Keys          | Type      | Descripction                                              |
| ------------- | ------    | --------------------------------------------------------- |
| clinet_type   | String    | The type of clinet `display` or `Controller`              |
| cluster_code  | Int       | The cluster code of the group connected to                |
| key           | Sting     | the key given to the client by the server                 |
| timestamp     | Timestamp | The time (in milliseconds) the connection was established |

>When trying to acsess this infromatrion from the `controller-connected` and `controller-disconnected` events, infromation is presented in an `array` formatt.

## Usfull snippets
Examples you may find useful to used within your application.

### Looping through connected controllers
The snippit below can be used with both the `controller-connected` and `controller-disconnected` events to retrieve all controllers infromation whom are connected to the display.

{% highlight javascript linenos %}
/*------------------------------------------------------
* @object - CWC Main Server Object
* @info   - initiate CWC Server Object
*/
var Server = new cwc.Server({
    host : 'http://localhost.com',
    port : 0000,
    type : 'ws'
});

/*------------------------------------------------------
* @object - CWC Main Hooks Object
* @info   - initiate CWC Hooks Object
*/
var Hooks = new cwc.Hooks({
});

/* -- Crete controller connected | Hook -- */
Hooks.set_hook( {
  hook_name : 'controller-connected',
  method    : function( controllers ) { controllers_loop( controllers ) }
} );

/* -- Crete controller disconnected | Hook -- */
Hooks.set_hook( {
  hook_name : 'controller-disconnected',
  method    : function( controllers ) { controllers_loop( controllers ) }
} );

/*------------------------------------------------------
* @methord - cwc.Server Connect methord
* @info    - cwc-display-master.js
* @info    - Hooks must be created before connecting
*/
Server.connect(
);

/*------------------------------------------------------
* @function - Controllers loop
* @info     - Callback function for controller-connected && controller-disconnected
*/
function controllers_loop( controllers )
{
    for( var i = 0; i < controllers.length; i++ )
    {
        var controller = controllers[ i ];
        console.log( controller );
    }
};
{% endhighlight %}